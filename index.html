<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Allocation Planning Tool</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 300; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .fullscreen-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            z-index: 100;
        }
        .fullscreen-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }
        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
        }
        .tab.active {
            background: white;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }
        .tab:hover:not(.active) { background: #e9ecef; }
        .tab-content { 
            display: none; 
            padding: 30px; 
            min-height: 600px;
            overflow-y: auto;
        }
        .tab-content.active { display: block; }
        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
        }
        .section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            font-weight: 600;
        }
        .section h4 {
            color: #34495e;
            margin: 15px 0 10px 0;
            font-size: 1.1em;
        }
        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }
        .input-group label {
            flex: 1;
            font-weight: 500;
            color: #2c3e50;
            margin-right: 15px;
        }
        .input-group input, .input-group select {
            width: 100px;
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 1em;
            margin-right: 15px;
            transition: border-color 0.3s ease;
        }
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
        }
        .result {
            min-width: 80px;
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            background: #ecf0f1;
            padding: 8px 12px;
            border-radius: 6px;
        }
        .summary {
            background: #e8f5e8;
            border: 2px solid #27ae60;
            color: #27ae60;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            margin-top: 15px;
        }
        .summary.warning {
            background: #fef9e7;
            border-color: #f39c12;
            color: #f39c12;
        }
        .summary.error {
            background: #fdf2f2;
            border-color: #e74c3c;
            color: #e74c3c;
        }
        .export-section {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid #3498db;
        }
        .export-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        .export-btn.sync {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }
        .guidelines-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .guideline-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
        }
        .remaining-hours {
            background: #cce5ff;
            border: 2px solid #0066cc;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        .remaining-hours h4 { color: #003d7a; margin-bottom: 5px; }
        .remaining-hours .hours-display {
            font-size: 2em;
            font-weight: bold;
            color: #0066cc;
        }
        .info-card {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .info-card p {
            font-size: 1.05em;
            line-height: 1.6;
            margin: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="fullscreen-btn" onclick="openFullscreen()">Open Full Screen</button>
            <h1>Time Allocation Planning Model</h1>
            <p>Strategic Workforce Planning for AOP 2026</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="instructions">Instructions & Guidelines</button>
            <button class="tab" data-tab="basic">Basic Planning</button>
            <button class="tab" data-tab="budget">Budget Planning</button>
        </div>

        <div id="instructions" class="tab-content active">
            <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-left: none;">
                <h3 style="color: white; font-size: 1.8em; margin-bottom: 15px;">How to Use This Tool</h3>
                <p style="font-size: 1.15em; line-height: 1.8;"><strong>This planning model helps managers and individual contributors work together to allocate employee time between billable and indirect activities for AOP planning.</strong></p>
            </div>

            <div class="guidelines-container" style="margin-top: 30px;">
                <div class="guideline-card" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; border: none;">
                    <h4 style="color: white; font-size: 1.3em; margin-bottom: 15px;">Set Clear Billable Expectations</h4>
                    <p style="margin-bottom: 12px;"><strong>Every employee must know their billable percentage target for the year.</strong></p>
                    <p style="font-size: 0.95em; line-height: 1.6;">As a people leader, you are responsible for:</p>
                    <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.95em; line-height: 1.7;">
                        <li>Communicating specific billable targets clearly at the beginning of each year</li>
                        <li>Explaining the rationale behind their target</li>
                        <li>Notifying employees immediately if targets change</li>
                    </ul>
                </div>
                <div class="guideline-card" style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; border: none;">
                    <h4 style="color: white; font-size: 1.3em; margin-bottom: 15px;">Empower Through Clarity</h4>
                    <p style="margin-bottom: 12px;"><strong>Clear expectations create autonomy and engagement.</strong></p>
                    <p style="font-size: 0.95em; line-height: 1.6;">When employees understand their time allocation:</p>
                    <ul style="margin-left: 20px; margin-top: 10px; font-size: 0.95em; line-height: 1.7;">
                        <li>They feel empowered to make better daily decisions</li>
                        <li>They have increased autonomy in managing workload</li>
                        <li>They can better balance competing demands</li>
                    </ul>
                </div>
            </div>

            <div class="section" style="margin-top: 30px;">
                <h3 style="text-align: center; margin-bottom: 25px; font-size: 1.6em;">Four Categories of Time Allocation</h3>
                <p style="text-align: center; margin-bottom: 15px; font-size: 1.05em;">All billable employees should understand that their time falls into 4 categories - all of which are business imperatives that drive productivity and growth. <strong>Billable percentages are set by the business during the AOP process. For the other categories, minimum hour guidelines are endorsed recommendations for employees.</strong></p>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-top: 25px;">
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #3498db; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">💼</div>
                        <h4 style="color: #3498db; margin-bottom: 10px; font-size: 1.2em;">1. Billable Hours</h4>
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Direct revenue generation and client service delivery</p>
                        <div style="background: #e8f4fd; padding: 10px; border-radius: 6px;">
                            <p style="font-size: 0.85em; margin: 0;">Core billable work related to client projects and direct service delivery</p>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #27ae60; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">⚙️</div>
                        <h4 style="color: #27ae60; margin-bottom: 10px; font-size: 1.2em;">2. Operational Indirect</h4>
                        <p style="font-size: 1.4em; font-weight: bold; color: #27ae60; margin-bottom: 5px;">300 hrs minimum</p>
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Operational excellence and regulatory compliance</p>
                        <div style="background: #e8f5e8; padding: 10px; border-radius: 6px;">
                            <p style="font-size: 0.85em; margin: 0;">PTO, Holiday, Training, Hiring, Travel, Admin, Business Activities</p>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #9b59b6; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">🚀</div>
                        <h4 style="color: #9b59b6; margin-bottom: 10px; font-size: 1.2em;">3. Strategic Initiatives</h4>
                        <p style="font-size: 1.4em; font-weight: bold; color: #9b59b6; margin-bottom: 5px;">40 hrs minimum</p>
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Long-term capability and competitive advantage</p>
                        <div style="background: #f4ecf7; padding: 10px; border-radius: 6px;">
                            <p style="font-size: 0.85em; margin: 0;">Upskilling/Reskilling, Innovation, Digital Transformation</p>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 3px solid #e67e22; text-align: center;">
                        <div style="font-size: 2.5em; margin-bottom: 10px;">🌟</div>
                        <h4 style="color: #e67e22; margin-bottom: 10px; font-size: 1.2em;">4. Employee Experience</h4>
                        <p style="font-size: 1.4em; font-weight: bold; color: #e67e22; margin-bottom: 5px;">24 hrs minimum</p>
                        <p style="font-size: 0.9em; color: #666; margin-bottom: 15px;">Engagement, retention, and professional growth</p>
                        <div style="background: #fef5e7; padding: 10px; border-radius: 6px;">
                            <p style="font-size: 0.85em; margin: 0;">Culture, ERGs, Wellbeing, Connectivity, Optional Development</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" style="background: #e8f5e8; border-left: 4px solid #27ae60; margin-top: 30px;">
                <h3 style="color: #27ae60; margin-bottom: 20px;">Category Allocation Example</h3>
                <p style="margin-bottom: 15px;"><strong>For an employee with an 80% Billable Percentage:</strong></p>
                <div style="background: white; padding: 20px; border-radius: 8px; margin-top: 15px;">
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; text-align: center;">
                        <div>
                            <p style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Operational</p>
                            <p style="font-size: 1.8em; font-weight: bold; color: #27ae60;">300</p>
                            <p style="font-size: 0.85em; color: #666;">hours min</p>
                        </div>
                        <div>
                            <p style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Strategic</p>
                            <p style="font-size: 1.8em; font-weight: bold; color: #9b59b6;">40</p>
                            <p style="font-size: 0.85em; color: #666;">hours min</p>
                        </div>
                        <div>
                            <p style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Employee Exp</p>
                            <p style="font-size: 1.8em; font-weight: bold; color: #e67e22;">24</p>
                            <p style="font-size: 0.85em; color: #666;">hours min</p>
                        </div>
                        <div>
                            <p style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Buffer Time</p>
                            <p style="font-size: 1.8em; font-weight: bold; color: #3498db;">52</p>
                            <p style="font-size: 0.85em; color: #666;">hours remaining</p>
                        </div>
                    </div>
                    <p style="margin-top: 20px; text-align: center; font-style: italic; color: #666; font-size: 0.95em;">These minimums leave 52 hours of buffer time to allocate based on employee interest and business needs</p>
                </div>
            </div>

            <div class="section" style="margin-top: 30px;">
                <h3>Scenario Planning & Comparisons</h3>
                <p>Compare different allocation scenarios to understand typical allocations for billable employees.</p>
                
                <table>
                    <tr>
                        <th>Employee Type</th>
                        <th>Billable %</th>
                        <th>Billable Hrs</th>
                        <th>Indirect Hrs</th>
                        <th>Op Min</th>
                        <th>Strat Min</th>
                        <th>EX Min</th>
                        <th>Buffer</th>
                    </tr>
                    <tr>
                        <td>Individual Contributor</td>
                        <td>80%</td>
                        <td>1,664</td>
                        <td>416</td>
                        <td>300</td>
                        <td>40</td>
                        <td>24</td>
                        <td>52</td>
                    </tr>
                    <tr>
                        <td>People Leader</td>
                        <td>50%</td>
                        <td>1,040</td>
                        <td>1,040</td>
                        <td>300</td>
                        <td>40</td>
                        <td>24</td>
                        <td>676</td>
                    </tr>
                </table>
            </div>

            <div class="section" style="margin-top: 30px;">
                <h3>Step-by-Step Instructions</h3>
                <ol style="line-height: 2; font-size: 1.05em;">
                    <li><strong>Collaborative Planning:</strong> Managers and individual contributors should fill this out together</li>
                    <li><strong>Start with Basic Planning:</strong> Select employee type and adjust billable percentage targets</li>
                    <li><strong>Create Budget:</strong> Use Budget Planning tab to translate into detailed BMO categories for AOP</li>
                    <li><strong>Export to CPM Compatible Sheet:</strong> Generate a CPM-compatible spreadsheet for direct alignment with CRM system</li>
                    <li><strong>Adjust as Needed:</strong> Balance allocations to stay within available indirect time</li>
                </ol>
            </div>

            <div class="section" style="background: #e8f4fd; border-left: 4px solid #3498db;">
                <h3 style="color: #2c3e50;">CPM Export Features</h3>
                <ul style="line-height: 2; font-size: 1.05em;">
                    <li><strong>CRM Integration:</strong> Export creates spreadsheet in exact CPM format required by company systems</li>
                    <li><strong>Monthly Distribution:</strong> Hours are automatically distributed across 2026 months based on workday percentages</li>
                    <li><strong>Strategic Categorization:</strong> Budget categories roll up into four key CPM buckets for streamlined reporting</li>
                    <li><strong>Annual Planning:</strong> Supports full fiscal year 2026 budgeting with monthly breakdowns</li>
                </ul>
            </div>
        </div>

        <div id="basic" class="tab-content">
            <div class="section">
                <h3>Employee Information</h3>
                <div class="input-group">
                    <label>Employee Name:</label>
                    <input type="text" id="employeeName" placeholder="Enter name">
                </div>
                <div class="input-group">
                    <label>Employee Type:</label>
                    <select id="employeeType" onchange="applyDefaults()">
                        <option value="IC">Individual Contributor</option>
                        <option value="PL">People Leader</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Total Working Hours (Annual):</label>
                    <input type="number" id="totalHours" value="2080" onchange="calculate()">
                    <span class="result" id="totalHoursDisp">2080</span>
                </div>
                <div class="input-group">
                    <label>Billable Percentage (%):</label>
                    <input type="number" id="billPct" value="80" onchange="calculate()">
                    <span class="result" id="billPctDisp">80%</span>
                </div>
                <div class="input-group">
                    <label>Billable Hours:</label>
                    <span class="result" id="billHrs">1664</span>
                </div>
                <div class="input-group">
                    <label>Total Indirect Hours Available:</label>
                    <span class="result" id="indirHrs">416</span>
                </div>
            </div>

            <div class="section" style="background: #e8f5e8; border-left: 4px solid #27ae60;">
                <h3 style="color: #27ae60;">Category 2: Operational Indirect Hours</h3>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <p style="font-size: 0.9em; color: #666;">Minimum Required: 300 hours</p>
                            <p style="font-size: 1.8em; font-weight: bold; margin: 0;" id="opTotal">364</p>
                        </div>
                        <div id="opBadge" style="padding: 10px 20px; border-radius: 6px; background: #e8f5e8; color: #27ae60; font-weight: bold;">
                            ✓ Meets Minimum
                        </div>
                    </div>
                </div>
                
                <div class="input-group"><label>PTO:</label><input type="number" id="pto" value="120" onchange="calculate()"><span class="result" id="ptoDisp">120</span></div>
                <div class="input-group"><label>Holiday Hours:</label><input type="number" id="holidays" value="64" onchange="calculate()"><span class="result" id="holidaysDisp">64</span></div>
                <div class="input-group"><label>Essential Time Travel:</label><input type="number" id="essentialTravel" value="20" onchange="calculate()"><span class="result" id="essentialTravelDisp">20</span></div>
                <div class="input-group"><label>Required Business Training:</label><input type="number" id="reqTrain" value="13" onchange="calculate()"><span class="result" id="reqTrainDisp">13</span></div>
                <div class="input-group"><label>Technical Training:</label><input type="number" id="techTrain" value="30" onchange="calculate()"><span class="result" id="techTrainDisp">30</span></div>
                <div class="input-group"><label>Hiring Activities:</label><input type="number" id="hiring" value="8" onchange="calculate()"><span class="result" id="hiringDisp">8</span></div>
                <div class="input-group"><label>Administrative:</label><input type="number" id="admin" value="15" onchange="calculate()"><span class="result" id="adminDisp">15</span></div>
                <div class="input-group"><label>Business Activities:</label><input type="number" id="bizAct" value="60" onchange="calculate()"><span class="result" id="bizActDisp">60</span></div>
            </div>

            <div class="info-card">
                <p><strong>If an employee is interested in or currently a cultural / ERG leader or leading a strategic initiative, please balance their time accordingly to support their developmental role.</strong></p>
            </div>

            <div class="info-card">
                <p><strong>If an employee is interested in or currently a cultural / ERG leader or leading a strategic initiative, please balance their time accordingly to support their developmental role.</strong></p>
            </div>

            <div class="section" style="background: #f4ecf7; border-left: 4px solid #9b59b6;">
                <h3 style="color: #9b59b6;">Category 3: Strategic Initiatives</h3>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <p style="font-size: 0.9em; color: #666;">Minimum Required: 40 hours</p>
                            <p style="font-size: 1.8em; font-weight: bold; margin: 0;" id="stratTotal">30</p>
                        </div>
                        <div id="stratBadge" style="padding: 10px 20px; border-radius: 6px; background: #fdf2f2; color: #e74c3c; font-weight: bold;">
                            ✗ Below Minimum (10 hrs short)
                        </div>
                    </div>
                </div>
                
                <div class="input-group"><label>Innovation Projects:</label><input type="number" id="innov" value="15" onchange="calculate()"><span class="result" id="innovDisp">15</span></div>
                <div class="input-group"><label>Digital Transformation:</label><input type="number" id="digital" value="10" onchange="calculate()"><span class="result" id="digitalDisp">10</span></div>
                <div class="input-group"><label>Upskilling / Reskilling:</label><input type="number" id="upskill" value="15" onchange="calculate()"><span class="result" id="upskillDisp">15</span></div>
            </div>

            <div class="section" style="background: #fef5e7; border-left: 4px solid #e67e22;">
                <h3 style="color: #e67e22;">Category 4: Employee Experience & Development</h3>
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between;">
                        <div>
                            <p style="font-size: 0.9em; color: #666;">Minimum Required: 24 hours</p>
                            <p style="font-size: 1.8em; font-weight: bold; margin: 0;" id="expTotal">25</p>
                        </div>
                        <div id="expBadge" style="padding: 10px 20px; border-radius: 6px; background: #e8f5e8; color: #27ae60; font-weight: bold;">
                            ✓ Meets Minimum
                        </div>
                    </div>
                </div>
                
                <div class="input-group"><label>Connectivity & Wellbeing:</label><input type="number" id="connectivity" value="15" onchange="calculate()"><span class="result" id="connectivityDisp">15</span></div>
                <div class="input-group"><label>ERG Participation:</label><input type="number" id="erg" value="0" onchange="calculate()"><span class="result" id="ergDisp">0</span></div>
                <div class="input-group"><label>Optional Professional Development:</label><input type="number" id="optDev" value="10" onchange="calculate()"><span class="result" id="optDevDisp">10</span></div>
                <div class="input-group"><label>Volunteer Hours:</label><input type="number" id="volunteer" value="0" onchange="calculate()"><span class="result" id="volunteerDisp">0</span></div>
            </div>

            <div class="section">
                <h3>Planning Summary</h3>
                                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #27ae60;">
                        <p style="font-size: 0.85em; color: #666;">Operational</p>
                        <p style="font-size: 1.5em; font-weight: bold; color: #27ae60;" id="opSummary">330</p>
                        <p style="font-size: 0.8em; color: #666;" id="opStatus">✓ Meets minimum</p>
                    </div>
                    <div style="background: #f4ecf7; padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #9b59b6;">
                        <p style="font-size: 0.85em; color: #666;">Strategic</p>
                        <p style="font-size: 1.5em; font-weight: bold; color: #9b59b6;" id="stratSummary">40</p>
                        <p style="font-size: 0.8em; color: #666;" id="stratStatus">✓ Meets minimum</p>
                    </div>
                    <div style="background: #fef5e7; padding: 15px; border-radius: 8px; text-align: center; border: 2px solid #e67e22;">
                        <p style="font-size: 0.85em; color: #666;">Employee Exp</p>
                        <p style="font-size: 1.5em; font-weight: bold; color: #e67e22;" id="expSummary">25</p>
                        <p style="font-size: 0.8em; color: #666;" id="expStatus">✓ Meets minimum</p>
                    </div>
                </div>
                
                <div class="input-group"><label>Total Allocated Indirect Hours:</label><span class="result" id="totalAlloc">395</span></div>
                <div class="input-group"><label>Buffer Time Remaining:</label><span class="result" id="buffer">21</span></div>
                <div id="statusMsg" class="summary">✓ All categories meet minimums, 21 hours buffer remaining</div>
            </div>

            <div class="export-section">
                <h3>Export & Planning Tools</h3>
                <button class="export-btn" onclick="exportToCPM()">Export CPM Spreadsheet</button>
                <button class="export-btn" onclick="window.print()">Print/PDF Report</button>
            </div>
        </div>

        <div id="budget" class="tab-content">
            <div class="section">
                <h3>Budget Planning - Detailed Breakdown</h3>
                <p>Break down your Basic Planning categories into detailed subcategories for AOP submission.</p>
                <div class="remaining-hours">
                    <h4>Buffer Time Available</h4>
                    <div class="hours-display" id="budgetBuffer">21</div>
                </div>
            </div>

            <div class="section" style="background: #e8f5e8; border-left: 4px solid #27ae60;">
                <h3 style="color: #27ae60;">Operational Indirect - Detailed Breakdown</h3>
                
                <h4>Travel Categories</h4>
                <div class="input-group"><label>Training Travel:</label><input type="number" value="7"><span class="result">7</span></div>
                <div class="input-group"><label>Client Travel:</label><input type="number" value="6"><span class="result">6</span></div>
                <div class="input-group"><label>Team Offsites Travel:</label><input type="number" value="7"><span class="result">7</span></div>
                
                <h4>Required Training Categories</h4>
                <div class="input-group"><label>Compliance Training:</label><input type="number" value="6"><span class="result">6</span></div>
                <div class="input-group"><label>Leadership Training:</label><input type="number" id="budgetLeadership" value="2"><span class="result">2</span></div>
                <div class="input-group"><label>Platform/Tech Training:</label><input type="number" value="5"><span class="result">5</span></div>
                
                <h4 style="margin-top: 20px;">Technical Training Categories</h4>
                <div class="input-group"><label>Certifications:</label><input type="number" value="15"><span class="result">15</span></div>
                <div class="input-group"><label>Other Technical Training:</label><input type="number" value="15"><span class="result">15</span></div>
                
                <h4 style="margin-top: 20px;">Hiring Categories</h4>
                <div class="input-group"><label>Recruiting:</label><input type="number" value="2"><span class="result">2</span></div>
                <div class="input-group"><label>Interviewing:</label><input type="number" value="6"><span class="result">6</span></div>
                
                <h4 style="margin-top: 20px;">Administrative Categories</h4>
                <div class="input-group"><label>Performance Reviews:</label><input type="number" id="budgetPerfReviews" value="4"><span class="result">4</span></div>
                <div class="input-group"><label>Internal Reporting:</label><input type="number" id="budgetReporting" value="7"><span class="result">7</span></div>
                <div class="input-group"><label>Employee Surveys:</label><input type="number" value="4"><span class="result">4</span></div>
                
                <h4 style="margin-top: 20px;">Business Activities</h4>
                <div class="input-group"><label>Team Meetings:</label><input type="number" value="26"><span class="result">26</span></div>
                <div class="input-group"><label>Town Halls:</label><input type="number" value="8"><span class="result">8</span></div>
                <div class="input-group"><label>Check-ins:</label><input type="number" value="16"><span class="result">16</span></div>
                <div class="input-group"><label>Team Offsites:</label><input type="number" value="10"><span class="result">10</span></div>
            </div>

            <div class="section" style="background: #f4ecf7; border-left: 4px solid #9b59b6;">
                <h3 style="color: #9b59b6;">Strategic Initiatives - Detailed Breakdown</h3>
                <div class="input-group"><label>Innovation Projects:</label><input type="number" value="15"><span class="result">15</span></div>
                <div class="input-group"><label>Digital Transformation:</label><input type="number" value="10"><span class="result">10</span></div>
                <div class="input-group"><label>Upskilling / Reskilling:</label><input type="number" value="15"><span class="result">15</span></div>
            </div>

            <div class="section" style="background: #fef5e7; border-left: 4px solid #e67e22;">
                <h3 style="color: #e67e22;">Employee Experience - Detailed Breakdown</h3>
                
                <h4>Culture & ERG Activities</h4>
                <div class="input-group"><label>ERG Member (5-10 hours annually):</label><input type="number" value="0"><span class="result">0</span></div>
                <div class="input-group"><label>ERG Leader (60 hours annually):</label><input type="number" value="0"><span class="result">0</span></div>
                <div class="input-group"><label>Council Member (12 hours annually):</label><input type="number" value="0"><span class="result">0</span></div>
                <div class="input-group"><label>Culture Committee Leader (120 hours annually):</label><input type="number" value="0"><span class="result">0</span></div>
                <div class="input-group"><label>Culture Committee Member (60 hours annually):</label><input type="number" value="0"><span class="result">0</span></div>
                <div class="input-group"><label>Wellbeing Activities:</label><input type="number" value="7"><span class="result">7</span></div>
                <div class="input-group"><label>Connectivity:</label><input type="number" value="8"><span class="result">8</span></div>
                <div class="input-group"><label>Volunteer Hours:</label><input type="number" value="8"><span class="result">8</span></div>
                
                <h4 style="margin-top: 20px;">Optional Professional Development</h4>
                <div class="input-group"><label>External Conferences:</label><input type="number" value="5"><span class="result">5</span></div>
                <div class="input-group"><label>External Training:</label><input type="number" value="5"><span class="result">5</span></div>
            </div>

            <div class="export-section">
                <h3>Export Budget Planning</h3>
                <button class="export-btn" onclick="exportToCPM()">Export Budget CPM Spreadsheet</button>
                <button class="export-btn sync" onclick="syncToBasic()">Sync to Basic Planning</button>
                <button class="export-btn" onclick="window.print()">Print Budget</button>
            </div>
        </div>
    </div>

    <script>
        function openFullscreen() {
            const elem = document.documentElement;
            
            try {
                if (!document.fullscreenElement && !document.webkitFullscreenElement && 
                    !document.mozFullScreenElement && !document.msFullscreenElement) {
                    // Try to enter fullscreen
                    if (elem.requestFullscreen) {
                        elem.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                            alert('Fullscreen mode is not available in this environment. For fullscreen functionality, please save this HTML file and open it in your browser.');
                        });
                    } else if (elem.webkitRequestFullscreen) {
                        elem.webkitRequestFullscreen();
                    } else if (elem.mozRequestFullScreen) {
                        elem.mozRequestFullScreen();
                    } else if (elem.msRequestFullscreen) {
                        elem.msRequestFullscreen();
                    } else {
                        alert('Fullscreen mode is not supported in this browser or environment.');
                    }
                } else {
                    // Exit fullscreen
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            } catch (err) {
                console.log('Fullscreen error:', err);
                alert('Unable to enter fullscreen mode. This may be restricted in embedded environments. Try opening this file in a standalone browser tab.');
            }
        }

        function exportToCPM() {
            try {
                const employeeName = get('employeeName').value || 'Employee';
                const employeeType = get('employeeType').value;
                const totalHours = val('totalHours');
                const billPct = val('billPct');
                const billableHours = Math.round(totalHours * billPct / 100);
                
                // Calculate CPM Bucket Totals
                const boldStepHours = val('innov') + val('digital') + val('upskill');
                const ptoHours = val('pto');
                const allOtherIndirect = val('holidays') + val('essentialTravel') + val('reqTrain') + 
                                        val('techTrain') + val('hiring') + val('admin') + val('bizAct') + 
                                        val('connectivity') + val('erg') + val('optDev') + val('volunteer');
                
                // Month percentages for 2026 based on workdays
                const months2026 = [
                    {month: 'January', percentage: 8.65},
                    {month: 'February', percentage: 7.69},
                    {month: 'March', percentage: 8.65},
                    {month: 'April', percentage: 8.27},
                    {month: 'May', percentage: 8.27},
                    {month: 'June', percentage: 8.65},
                    {month: 'July', percentage: 8.65},
                    {month: 'August', percentage: 8.65},
                    {month: 'September', percentage: 8.27},
                    {month: 'October', percentage: 8.65},
                    {month: 'November', percentage: 7.69},
                    {month: 'December', percentage: 7.31}
                ];
                
                // Build CPM data array
                let cpmData = [];
                
                // Header row - employee info then months, then total
                let headerRow = ['Budget Planning Export: ' + employeeName, 'Employee Type: ' + (employeeType === 'IC' ? 'Individual Contributor' : 'People Leader')];
                months2026.forEach(month => headerRow.push(month.month + ' 2026'));
                headerRow.push('Total 2026');
                cpmData.push(headerRow);
                
                // Empty row
                cpmData.push(['']);
                
                // Direct Override (Billable Hours)
                cpmData.push(['Direct Override (Billable Hours)', '']);
                let directOverrideRow = ['  Direct Override', ''];
                let directTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(billableHours * (month.percentage / 100));
                    directOverrideRow.push(monthlyHours);
                    directTotal += monthlyHours;
                });
                directOverrideRow.push(directTotal);
                cpmData.push(directOverrideRow);
                
                // Empty row
                cpmData.push(['']);
                
                // Bold Step Hours
                cpmData.push(['Bold Step Hours', '']);
                let boldStepRow = ['  Bold Step Override', ''];
                let boldTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(boldStepHours * (month.percentage / 100));
                    boldStepRow.push(monthlyHours);
                    boldTotal += monthlyHours;
                });
                boldStepRow.push(boldTotal);
                cpmData.push(boldStepRow);
                
                // Empty row
                cpmData.push(['']);
                
                // PTO Usage Override
                cpmData.push(['PTO Usage Override', '']);
                let ptoOverrideRow = ['  PTO Usage Override', ''];
                let ptoTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(ptoHours * (month.percentage / 100));
                    ptoOverrideRow.push(monthlyHours);
                    ptoTotal += monthlyHours;
                });
                ptoOverrideRow.push(ptoTotal);
                cpmData.push(ptoOverrideRow);
                
                // Empty row
                cpmData.push(['']);
                
                // All other Indirect Hours
                cpmData.push(['All other Indirect Hours', '']);
                let allOtherRow = ['  All other Indirect Override', ''];
                let allOtherTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(allOtherIndirect * (month.percentage / 100));
                    allOtherRow.push(monthlyHours);
                    allOtherTotal += monthlyHours;
                });
                allOtherRow.push(allOtherTotal);
                cpmData.push(allOtherRow);
                
                // Convert to CSV format
                let csvContent = '';
                cpmData.forEach(row => {
                    let csvRow = row.map(cell => {
                        if (typeof cell === 'string' && cell.indexOf(',') !== -1) {
                            return '"' + cell + '"';
                        }
                        return cell;
                    }).join(',');
                    csvContent += csvRow + '\n';
                });
                
                // Create download
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = employeeName.replace(/\s+/g, '_') + '_CPM_Export_2026.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                alert('CPM Export Complete!\n\nFile: ' + employeeName.replace(/\s+/g, '_') + '_CPM_Export_2026.csv\n\nYour planning data has been exported in CPM format with monthly distribution across 2026.\n\nFour CPM Buckets:\n- Direct Override (Billable): ' + directTotal + ' hrs\n- Bold Step Override: ' + boldTotal + ' hrs\n- PTO Usage Override: ' + ptoTotal + ' hrs\n- All Other Indirect: ' + allOtherTotal + ' hrs');
                
            } catch (error) {
                alert('CPM export failed. Please try again or contact support.');
                console.error('CPM Export Error:', error);
            }
        }

        function syncToBasic() {
            alert('Sync functionality: This would sync detailed budget values back to basic planning categories. Feature coming soon!');
        }

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const targetTab = this.getAttribute('data-tab');
                
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(targetTab).classList.add('active');
            });
        });

        function get(id) { return document.getElementById(id); }
        function val(id) { const el = get(id); return el ? (parseInt(el.value) || 0) : 0; }
        function set(id, v) { const el = get(id); if(el) el.textContent = v; }

        function calculate() {
            const total = val('totalHours');
            const pct = val('billPct');
            const bill = Math.round(total * pct / 100);
            const indir = total - bill;
            
            set('totalHoursDisp', total);
            set('billPctDisp', pct + '%');
            set('billHrs', bill);
            set('indirHrs', indir);
            
            const op = val('pto') + val('holidays') + val('essentialTravel') + val('reqTrain') + val('techTrain') + val('hiring') + val('admin') + val('bizAct');
            set('opTotal', op);
            set('opSummary', op);
            const opShort = 300 - op;
            set('opStatus', opShort > 0 ? opShort + ' hrs short' : '✓ Meets minimum');
            const opBadge = get('opBadge');
            if(opBadge) {
                opBadge.textContent = opShort > 0 ? '✗ Below Minimum (' + opShort + ' hrs short)' : '✓ Meets Minimum';
                opBadge.style.background = opShort > 0 ? '#fdf2f2' : '#e8f5e8';
                opBadge.style.color = opShort > 0 ? '#e74c3c' : '#27ae60';
            }
            
            const strat = val('innov') + val('digital') + val('upskill');
            set('stratTotal', strat);
            set('stratSummary', strat);
            const stratShort = 40 - strat;
            set('stratStatus', stratShort > 0 ? stratShort + ' hrs short' : '✓ Meets minimum');
            const stratBadge = get('stratBadge');
            if(stratBadge) {
                stratBadge.textContent = stratShort > 0 ? '✗ Below Minimum (' + stratShort + ' hrs short)' : '✓ Meets Minimum';
                stratBadge.style.background = stratShort > 0 ? '#fdf2f2' : '#e8f5e8';
                stratBadge.style.color = stratShort > 0 ? '#e74c3c' : '#27ae60';
            }
            
            const exp = val('connectivity') + val('erg') + val('optDev') + val('volunteer');
            set('expTotal', exp);
            set('expSummary', exp);
            const expShort = 24 - exp;
            set('expStatus', expShort > 0 ? expShort + ' hrs short' : '✓ Meets minimum');
            const expBadge = get('expBadge');
            if(expBadge) {
                expBadge.textContent = expShort > 0 ? '✗ Below Minimum (' + expShort + ' hrs short)' : '✓ Meets Minimum';
                expBadge.style.background = expShort > 0 ? '#fdf2f2' : '#e8f5e8';
                expBadge.style.color = expShort > 0 ? '#e74c3c' : '#27ae60';
            }
            
            const alloc = op + strat + exp;
            const buff = indir - alloc;
            set('totalAlloc', alloc);
            set('buffer', buff);
            set('budgetBuffer', buff);
            
            const msg = get('statusMsg');
            if(msg) {
                if (buff < 0) {
                    msg.textContent = '⚠ Over allocated by ' + Math.abs(buff) + ' hours';
                    msg.className = 'summary error';
                } else if (opShort > 0 || stratShort > 0 || expShort > 0) {
                    msg.textContent = '⚠ Review category minimums before proceeding';
                    msg.className = 'summary warning';
                } else {
                    msg.textContent = '✓ All categories meet minimums, ' + buff + ' hours buffer remaining';
                    msg.className = 'summary';
                }
            }
            
            ['pto','holidays','essentialTravel','reqTrain','techTrain','hiring','admin','bizAct','innov','digital','upskill','connectivity','erg','optDev','volunteer'].forEach(function(id) {
                set(id + 'Disp', val(id));
            });
        }

        function applyDefaults() {
            const type = get('employeeType').value;
            if(type === 'PL') {
                get('billPct').value = 50;
                if(get('budgetPerfReviews')) {
                    get('budgetPerfReviews').value = 20;
                }
                if(get('budgetLeadership')) {
                    get('budgetLeadership').value = 12;
                }
                if(get('budgetReporting')) {
                    get('budgetReporting').value = 12;
                }
            } else {
                get('billPct').value = 80;
                if(get('budgetPerfReviews')) {
                    get('budgetPerfReviews').value = 4;
                }
                if(get('budgetLeadership')) {
                    get('budgetLeadership').value = 2;
                }
                if(get('budgetReporting')) {
                    get('budgetReporting').value = 7;
                }
            }
            calculate();
        }

        setTimeout(calculate, 100);
    </script>
</body>
</html>
