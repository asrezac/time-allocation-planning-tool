<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Time Allocation Planning Model</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            color: #666;
            transition: all 0.3s ease;
        }

        .tab.active {
            background: white;
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
        }

        .tab:hover:not(.active) {
            background: #e9ecef;
        }

        .tab-content {
            display: none;
            padding: 30px;
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 4px solid #3498db;
        }

        .section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.4em;
            font-weight: 600;
        }

        .section h4 {
            color: #34495e;
            margin: 15px 0 10px 0;
            font-size: 1.1em;
        }

        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e5e9;
        }

        .input-group label {
            flex: 1;
            font-weight: 500;
            color: #2c3e50;
            margin-right: 15px;
        }

        .input-group input, .input-group select {
            width: 100px;
            padding: 8px 12px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 1em;
            margin-right: 15px;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
        }

        .result {
            min-width: 80px;
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            background: #ecf0f1;
            padding: 8px 12px;
            border-radius: 6px;
        }

        .summary {
            background: #e8f5e8;
            border: 2px solid #27ae60;
            color: #27ae60;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            text-align: center;
            margin-top: 15px;
        }

        .summary.warning {
            background: #fef9e7;
            border-color: #f39c12;
            color: #f39c12;
        }

        .summary.error {
            background: #fdf2f2;
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .export-section {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 25px;
            margin-top: 25px;
            border-left: 4px solid #3498db;
        }

        .export-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .export-btn.sync {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .export-btn.sync:hover {
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .guidelines-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .guidelines-container {
                grid-template-columns: 1fr;
            }
        }

        .guideline-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e1e5e9;
        }

        .guideline-card h4 {
            color: #3498db;
            margin-bottom: 10px;
        }

        .culture-leadership {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .culture-leadership h4 {
            color: #856404;
            margin-bottom: 15px;
        }

        .culture-leadership ul {
            list-style-type: none;
            padding-left: 0;
        }

        .culture-leadership li {
            padding: 5px 0;
            color: #856404;
            font-weight: 500;
        }

        .budget-headers {
            background: #d4edda;
            border: 2px solid #28a745;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .budget-headers h4 {
            color: #155724;
            margin-bottom: 10px;
        }

        .remaining-hours {
            background: #cce5ff;
            border: 2px solid #0066cc;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .remaining-hours h4 {
            color: #003d7a;
            margin-bottom: 5px;
        }

        .remaining-hours .hours-display {
            font-size: 2em;
            font-weight: bold;
            color: #0066cc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Enhanced Time Allocation Planning Model</h1>
            <p>Strategic Workforce Planning for AOP 2026</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchToTab('instructions')">Instructions & Guidelines</button>
            <button class="tab" onclick="switchToTab('basic')">Basic Planning</button>
            <button class="tab" onclick="switchToTab('budget')">Budget Planning</button>
            <button class="tab" onclick="switchToTab('scenarios')">Scenario Planning</button>
        </div>

        <!-- Instructions Tab -->
        <div id="instructions" class="tab-content active">
            <div class="section">
                <h3>How to Use This Tool</h3>
                <p><strong>This planning model helps managers and individual contributors work together to allocate employee time between billable and indirect activities for AOP planning.</strong></p>
                
                <h4>Step-by-Step Instructions:</h4>
                <ol>
                    <li><strong>Collaborative Planning:</strong> Managers and individual contributors should fill this out together</li>
                    <li><strong>Start with Basic Planning:</strong> Select employee type and adjust utilization targets</li>
                    <li><strong>Create Budget:</strong> Use Budget Planning tab to translate into detailed BMO categories for AOP</li>
                    <li><strong>Export to CPM Compatible Sheet:</strong> Generate a CPM-compatible spreadsheet for direct import into company CRM system</li>
                    <li><strong>Adjust as Needed:</strong> Balance allocations to stay within available indirect time</li>
                </ol>
                
                <h4>CPM Export Features:</h4>
                <ul>
                    <li><strong>Direct CRM Integration:</strong> Export creates spreadsheet in exact CPM format required by company systems</li>
                    <li><strong>Monthly Distribution:</strong> Hours are automatically distributed across 2026 months based on work day percentages</li>
                    <li><strong>Strategic Categorization:</strong> Budget categories roll up into four key CPM buckets for streamlined reporting</li>
                    <li><strong>Annual Planning:</strong> Supports full fiscal year 2026 budgeting with monthly breakdowns</li>
                </ul>
            </div>

            <div class="section">
                <h3>Leadership Accountability Framework</h3>
                <p><strong>People Leaders managing billable employees have a fiduciary responsibility to proactively engage in strategic workforce planning conversations.</strong> This includes conducting structured discussions with team members to identify individual professional development priorities, align personal growth objectives with organizational strategic initiatives, and optimize indirect time allocation to maximize both employee engagement and business value creation.</p>
            </div>
            
            <div class="section">
                <h3>Strategic Allocation Guidelines for Indirect Time</h3>
                <p>To ensure optimal return on human capital investment, managers should use the following strategic allocation framework to guide their planning for available indirect hours:</p>
                <ol>
                    <li><strong>20% Optional Training/Development Opportunities</strong> - Builds future capability pipeline and maintains competitive skill sets</li>
                    <li><strong>30% Culture & Employee Experience Activities</strong> - Drives engagement metrics, retention rates, and organizational culture strength</li>
                    <li><strong>50% Business-Related Activities</strong> - Ensures operational excellence and strategic alignment</li>
                </ol>
                <p><em>Note: These percentages should be applied to discretionary time after accounting for mandatory requirements (PTO, holidays, required training, administrative duties).</em></p>
                
                <div class="culture-leadership">
                    <h4>Cultural Leadership Allocation:</h4>
                    <p>For employees interested in cultural leadership roles, allocate:</p>
                    <ul>
                        <li><strong>ERG Member (5-7 hours annually)</strong></li>
                        <li><strong>ERG Leaders (60 hours annually)</strong></li>
                        <li><strong>ERG Leader Development (16 hours annually)</strong></li>
                        <li><strong>EX Council (12 hours annually)</strong></li>
                        <li><strong>Culture Committee Member (60 hours annually)</strong></li>
                        <li><strong>Culture Committee Chair or Assistant Chair (120 hours annually)</strong></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Basic Planning Tab -->
        <div id="basic" class="tab-content">
            <div class="section">
                <h3>Employee Information</h3>
                <div class="input-group">
                    <label>Employee Name:</label>
                    <input type="text" id="employeeName" placeholder="Enter name" onchange="runBasicCalculations()">
                </div>
                <div class="input-group">
                    <label>Employee Type:</label>
                    <select id="employeeType" onchange="applyEmployeeDefaults()">
                        <option value="Individual Contributor">Individual Contributor</option>
                        <option value="People Leader">People Leader</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Life Line Sector:</label>
                    <select id="lls" onchange="runBasicCalculations()">
                        <option value="Transportation">Transportation</option>
                        <option value="Healthcare">Healthcare</option>
                        <option value="Financial Services">Financial Services</option>
                        <option value="Energy">Energy</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Total Working Hours (Annual):</label>
                    <input type="number" id="totalHours" value="2080" onchange="runBasicCalculations()">
                    <span class="result" id="totalHoursDisplay">2080</span>
                </div>
                <div class="input-group">
                    <label>Target Utilization (%):</label>
                    <input type="number" id="utilization" value="80" onchange="runBasicCalculations()">
                    <span class="result" id="utilizationDisplay">80%</span>
                </div>
                <div class="input-group">
                    <label>Billable Hours:</label>
                    <span class="result" id="billableHoursDisplay">1664</span>
                </div>
                <div class="input-group">
                    <label>Total Indirect Hours Available:</label>
                    <span class="result" id="indirectHoursDisplay">416</span>
                </div>
            </div>

            <div class="section">
                <h3>Essential Indirect Categories</h3>
                <div class="input-group">
                    <label>PTO:</label>
                    <input type="number" id="pto" value="120" onchange="runBasicCalculations()">
                    <span class="result" id="ptoDisplay">120</span>
                </div>
                <div class="input-group">
                    <label>Holiday Hours:</label>
                    <input type="number" id="holidays" value="64" onchange="runBasicCalculations()">
                    <span class="result" id="holidaysDisplay">64</span>
                </div>
                <div class="input-group">
                    <label>Travel Time:</label>
                    <input type="number" id="travel" value="27" onchange="runBasicCalculations()">
                    <span class="result" id="travelDisplay">27</span>
                </div>
                <div class="input-group">
                    <label>Required Business Training:</label>
                    <input type="number" id="businessTraining" value="13" onchange="runBasicCalculations()">
                    <span class="result" id="businessTrainingDisplay">13</span>
                </div>
                <div class="input-group">
                    <label>Technical Training:</label>
                    <input type="number" id="techTraining" value="30" onchange="runBasicCalculations()">
                    <span class="result" id="techTrainingDisplay">30</span>
                </div>
                <div class="input-group">
                    <label>Hiring Activities:</label>
                    <input type="number" id="hiring" value="8" onchange="runBasicCalculations()">
                    <span class="result" id="hiringDisplay">8</span>
                </div>
                <div class="input-group">
                    <label>Administrative:</label>
                    <input type="number" id="admin" value="25" onchange="runBasicCalculations()">
                    <span class="result" id="adminDisplay">25</span>
                </div>
            </div>

            <div class="section">
                <h3>Strategic & Development Indirect Activities</h3>
                <div class="culture-leadership">
                    <h4>If an employee is interested in or currently a Culture / ERG leader or leading a strategic initiative, please balance their time accordingly to support their developmental role.</h4>
                </div>
                <div class="input-group">
                    <label>Strategy / Innovation:</label>
                    <input type="number" id="innovation" value="19" onchange="runBasicCalculations()">
                    <span class="result" id="innovationDisplay">19</span>
                </div>
                <div class="input-group">
                    <label>Culture & Employee Experience:</label>
                    <input type="number" id="culture" value="22" onchange="runBasicCalculations()">
                    <span class="result" id="cultureDisplay">22</span>
                </div>
                <div class="input-group">
                    <label>Volunteer Hours:</label>
                    <input type="number" id="volunteer" value="8" onchange="runBasicCalculations()">
                    <span class="result" id="volunteerDisplay">8</span>
                </div>
                <div class="input-group">
                    <label>Optional Professional Development:</label>
                    <input type="number" id="optionalDev" value="17" onchange="runBasicCalculations()">
                    <span class="result" id="optionalDevDisplay">17</span>
                </div>
                <div class="input-group">
                    <label>Business Activities:</label>
                    <input type="number" id="businessActivities" value="55" onchange="runBasicCalculations()">
                    <span class="result" id="businessActivitiesDisplay">55</span>
                </div>
            </div>

            <div class="section">
                <h3>Summary</h3>
                <div class="input-group">
                    <label>Total Allocated Indirect Hours:</label>
                    <span class="result" id="totalAllocatedDisplay">408</span>
                </div>
                <div class="input-group">
                    <label>Buffer Time:</label>
                    <span class="result" id="bufferTimeDisplay">8</span>
                </div>
                <div id="basicStatusMessage" class="summary">Status: Within limits</div>
            </div>

            <div class="export-section">
                <h3>Export & Planning Tools</h3>
                <p><strong>Export your planning for AOP submission and team replication:</strong></p>
                <button class="export-btn" onclick="exportBasicCPM()">Export Basic CPM Spreadsheet</button>
                <button class="export-btn" onclick="printPlanningReport()">Print/PDF Report</button>
                <button class="export-btn" onclick="resetAllData()">Clear for Next Employee</button>
                <p><em>Use CPM Export for direct import into company CRM system. Holiday hours are included in All Other Indirect.</em></p>
            </div>
        </div>

        <!-- Budget Planning Tab -->
        <div id="budget" class="tab-content">
            <div class="section">
                <h3>Complete Budget Planning (BMO Category Breakdown)</h3>
                <p><strong>Translate your Basic Planning into detailed BMO categories for AOP submission.</strong></p>
                
                <div class="remaining-hours">
                    <h4>Remaining Indirect Hours (Buffer Time)</h4>
                    <div class="hours-display" id="budgetBufferDisplay">8</div>
                    <p>Available buffer time from Basic Planning</p>
                </div>

                <div class="culture-leadership">
                    <h4>If a team member is interested in or already a Culture/ERG Leader, please work to adjust their billable target utilization to be able to fulfill their commitment to the hours below:</h4>
                    <ul>
                        <li><strong>ERG Member (5-7 hours annually)</strong></li>
                        <li><strong>ERG Leaders (60 hours annually)</strong></li>
                        <li><strong>ERG Leader Development (16 hours annually)</strong></li>
                        <li><strong>EX Council (12 hours annually)</strong></li>
                        <li><strong>Culture Committee Member (60 hours annually)</strong></li>
                        <li><strong>Culture Committee Chair or Assistant Chair (120 hours annually)</strong></li>
                    </ul>
                </div>
            </div>

            <div class="budget-headers">
                <h4>Essential Indirect Categories</h4>
            </div>

            <div class="section">
                <h3>PTO Categories</h3>
                <div class="input-group">
                    <label>PTO:</label>
                    <input type="number" id="budgetPTO" value="120" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetPTODisplay">120</span>
                </div>
            </div>

            <div class="section">
                <h3>Travel Categories</h3>
                <div class="input-group">
                    <label>Conference Travel:</label>
                    <input type="number" id="budgetConferenceTravel" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetConferenceTravelDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Training Travel:</label>
                    <input type="number" id="budgetTrainingTravel" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTrainingTravelDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Client Travel:</label>
                    <input type="number" id="budgetClientTravel" value="6" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetClientTravelDisplay">6</span>
                </div>
                <div class="input-group">
                    <label>Team Offsites:</label>
                    <input type="number" id="budgetTeamOffsitesTravel" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTeamOffsitesTravelDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Other Travel:</label>
                    <input type="number" id="budgetTravelOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTravelOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Required Training Categories</h3>
                <div class="input-group">
                    <label>Compliance Training:</label>
                    <input type="number" id="budgetCompliance" value="4" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetComplianceDisplay">4</span>
                </div>
                <div class="input-group">
                    <label>Leadership/Management Training:</label>
                    <input type="number" id="budgetLeadership" value="5" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetLeadershipDisplay">5</span>
                </div>
                <div class="input-group">
                    <label>Platform/Technology Training:</label>
                    <input type="number" id="budgetPlatform" value="4" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetPlatformDisplay">4</span>
                </div>
                <div class="input-group">
                    <label>Other Business Training:</label>
                    <input type="number" id="budgetBusinessTrainingOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetBusinessTrainingOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Technical Training Categories</h3>
                <div class="input-group">
                    <label>Certifications:</label>
                    <input type="number" id="budgetCertifications" value="15" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetCertificationsDisplay">15</span>
                </div>
                <div class="input-group">
                    <label>Upskilling/Reskilling:</label>
                    <input type="number" id="budgetUpskilling" value="15" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetUpskillingDisplay">15</span>
                </div>
                <div class="input-group">
                    <label>Other Technical Training:</label>
                    <input type="number" id="budgetTechTrainingOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTechTrainingOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Hiring Categories</h3>
                <div class="input-group">
                    <label>Recruiting:</label>
                    <input type="number" id="budgetRecruiting" value="2" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetRecruitingDisplay">2</span>
                </div>
                <div class="input-group">
                    <label>Interviewing:</label>
                    <input type="number" id="budgetInterviewing" value="6" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetInterviewingDisplay">6</span>
                </div>
                <div class="input-group">
                    <label>Onboarding:</label>
                    <input type="number" id="budgetOnboarding" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetOnboardingDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Other Hiring Activities:</label>
                    <input type="number" id="budgetHiringOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetHiringOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Administrative Categories</h3>
                <div class="input-group">
                    <label>Performance Reviews:</label>
                    <input type="number" id="budgetReviews" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetReviewsDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Internal Reporting:</label>
                    <input type="number" id="budgetReporting" value="12" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetReportingDisplay">12</span>
                </div>
                <div class="input-group">
                    <label>Employee Surveys:</label>
                    <input type="number" id="budgetSurveys" value="6" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetSurveysDisplay">6</span>
                </div>
                <div class="input-group">
                    <label>Other Administrative:</label>
                    <input type="number" id="budgetAdminOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetAdminOtherDisplay">0</span>
                </div>
            </div>

            <div class="budget-headers">
                <h4>Strategic & Development Indirect Activities</h4>
            </div>

            <div class="culture-leadership">
                <h4>If an employee is interested in or currently a Culture / ERG leader or leading a strategic initiative, please balance their time accordingly to support their developmental role.</h4>
            </div>

            <div class="section">
                <h3>Strategy/Innovation Categories</h3>
                <div class="input-group">
                    <label>Innovation Projects:</label>
                    <input type="number" id="budgetInnovationProjects" value="10" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetInnovationProjectsDisplay">10</span>
                </div>
                <div class="input-group">
                    <label>Digital Transformation:</label>
                    <input type="number" id="budgetDigitalTransform" value="9" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetDigitalTransformDisplay">9</span>
                </div>
                <div class="input-group">
                    <label>Other Innovation:</label>
                    <input type="number" id="budgetInnovationOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetInnovationOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Culture & Employee Experience Categories</h3>
                <div class="input-group">
                    <label>ERG Member:</label>
                    <input type="number" id="budgetERGMember" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetERGMemberDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>ERG Leader:</label>
                    <input type="number" id="budgetERGLeader" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetERGLeaderDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>ERG Leader Development:</label>
                    <input type="number" id="budgetERGDevelopment" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetERGDevelopmentDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>EX Council:</label>
                    <input type="number" id="budgetEXCouncil" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetEXCouncilDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Culture Committee Member:</label>
                    <input type="number" id="budgetCultureMember" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetCultureMemberDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Culture Committee Chair:</label>
                    <input type="number" id="budgetCultureChair" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetCultureChairDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Wellbeing Activities:</label>
                    <input type="number" id="budgetWellbeing" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetWellbeingDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Connectivity/Team Building:</label>
                    <input type="number" id="budgetConnectivity" value="8" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetConnectivityDisplay">8</span>
                </div>
                <div class="input-group">
                    <label>Other Culture Activities:</label>
                    <input type="number" id="budgetCultureOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetCultureOtherDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Volunteer Hours:</label>
                    <input type="number" id="budgetVolunteer" value="8" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetVolunteerDisplay">8</span>
                </div>
            </div>

            <div class="section">
                <h3>Professional Development Categories</h3>
                <div class="input-group">
                    <label>External Conferences:</label>
                    <input type="number" id="budgetExternalConf" value="8" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetExternalConfDisplay">8</span>
                </div>
                <div class="input-group">
                    <label>External Training:</label>
                    <input type="number" id="budgetExternalTraining" value="9" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetExternalTrainingDisplay">9</span>
                </div>
                <div class="input-group">
                    <label>Other Optional Development:</label>
                    <input type="number" id="budgetOptionalDevOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetOptionalDevOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Business Activities Categories</h3>
                <div class="input-group">
                    <label>Team Meetings:</label>
                    <input type="number" id="budgetTeamMeetings" value="26" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTeamMeetingsDisplay">26</span>
                </div>
                <div class="input-group">
                    <label>Town Halls:</label>
                    <input type="number" id="budgetTownHalls" value="6" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTownHallsDisplay">6</span>
                </div>
                <div class="input-group">
                    <label>Check-ins:</label>
                    <input type="number" id="budgetCheckins" value="16" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetCheckinsDisplay">16</span>
                </div>
                <div class="input-group">
                    <label>Team Offsites:</label>
                    <input type="number" id="budgetTeamOffsitesBusiness" value="7" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetTeamOffsitesBusinessDisplay">7</span>
                </div>
                <div class="input-group">
                    <label>Proposals/Business Development:</label>
                    <input type="number" id="budgetProposals" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetProposalsDisplay">0</span>
                </div>
                <div class="input-group">
                    <label>Other Business Activities:</label>
                    <input type="number" id="budgetBusinessOther" value="0" onchange="runBudgetCalculations()">
                    <span class="result" id="budgetBusinessOtherDisplay">0</span>
                </div>
            </div>

            <div class="section">
                <h3>Strategic Allocation Guidelines Breakdown</h3>
                <div class="guidelines-container">
                    <div class="guideline-card">
                        <h4>20% Optional Development (Target: <span id="devTargetHours">30</span> hours)</h4>
                        <p>Actual: <span id="devActualHours">17</span> hours (<span id="devActualPercent">14</span>%)</p>
                        <p>Status: <span id="devComplianceStatus">Under Target</span></p>
                    </div>
                    <div class="guideline-card">
                        <h4>30% Culture Activities (Target: <span id="cultureTargetHours">36</span> hours)</h4>
                        <p>Actual: <span id="cultureActualHours">30</span> hours (<span id="cultureActualPercent">25</span>%)</p>
                        <p>Status: <span id="cultureComplianceStatus">Under Target</span></p>
                    </div>
                    <div class="guideline-card">
                        <h4>50% Business Activities (Target: <span id="businessTargetHours">54</span> hours)</h4>
                        <p>Actual: <span id="businessActualHours">74</span> hours (<span id="businessActualPercent">61</span>%)</p>
                        <p>Status: <span id="businessComplianceStatus">Over Target</span></p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3>Complete Budget Summary</h3>
                <div class="input-group">
                    <label>Total Essential Categories:</label>
                    <span class="result" id="budgetEssentialTotalDisplay">287</span>
                </div>
                <div class="input-group">
                    <label>Total Strategic Categories:</label>
                    <span class="result" id="budgetStrategicTotalDisplay">121</span>
                </div>
                <div class="input-group">
                    <label>Total Budget Hours:</label>
                    <span class="result" id="budgetGrandTotalDisplay">408</span>
                </div>
                <div class="input-group">
                    <label>Buffer Time Available:</label>
                    <span class="result" id="budgetRemainingBufferDisplay">8</span>
                </div>
                <div id="budgetStatusMessage" class="summary">Budget Status: Balanced</div>
            </div>

            <div class="export-section">
                <h3>Export Budget Planning</h3>
                <p><strong>Export your detailed budget breakdown for AOP submission:</strong></p>
                <button class="export-btn" onclick="exportBudgetCPM()">Export Budget CPM Spreadsheet</button>
                <button class="export-btn sync" onclick="syncBudgetToBasic()">Sync to Basic Planning</button>
                <p><em>Budget CPM Export includes all detailed categories rolled up into CPM format. Use Sync to update Basic Planning with budget changes.</em></p>
            </div>
        </div>

        <!-- Scenario Planning Tab -->
        <div id="scenarios" class="tab-content">
            <div class="section">
                <h3>Scenario Planning & Comparisons</h3>
                <p><strong>The utilization targets listed below are averages, not requirements. Compare different allocation scenarios below to understand average allocations for billable employees.</strong></p>
                
                <table>
                    <tr>
                        <th>Employee Type</th>
                        <th>Target Utilization</th>
                        <th>Billable Hours</th>
                        <th>Indirect Hours</th>
                        <th>Strategic Time Available</th>
                    </tr>
                    <tr>
                        <td>Individual Contributor</td>
                        <td>80%</td>
                        <td>1,664</td>
                        <td>416</td>
                        <td>~129</td>
                    </tr>
                    <tr>
                        <td>People Leader</td>
                        <td>50%</td>
                        <td>1,040</td>
                        <td>1,040</td>
                        <td>~713</td>
                    </tr>
                </table>
                
                <h4>Strategic Time Allocation Framework</h4>
                <p>After accounting for essential categories (PTO, holidays, travel, required training, hiring, administrative), remaining strategic time should be allocated as:</p>
                <ul>
                    <li><strong>20% Optional Development</strong> - Conferences, external training, certifications</li>
                    <li><strong>30% Culture & Employee Experience</strong> - ERGs, wellbeing, connectivity, volunteer work</li>
                    <li><strong>50% Business Activities</strong> - Team meetings, town halls, check-ins, innovation</li>
                </ul>
            </div>

            <div class="section">
                <h3>Current vs. Target Analysis</h3>
                <div id="scenarioAnalysisDisplay">
                    <h4>Current Configuration: Individual Contributor</h4>
                    <p><strong>Utilization:</strong> 80% (1,664 billable hours)</p>
                    <p><strong>Indirect Hours:</strong> 416 hours available</p>
                    <p><strong>Strategic Time:</strong> ~129 hours after essential categories</p>
                    <p><strong>Balanced Approach:</strong> Standard allocation following 20/30/50 framework.</p>
                    <p><strong>Recommended Allocation:</strong> Development (20%), Culture (30%), Business (50%).</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Fresh JavaScript implementation - no conflicts with previous models
        
        // Current employee type for conditional logic
        let currentEmployeeType = 'Individual Contributor';
        
        // Utility functions
        function getFieldValue(fieldId, defaultVal = 0) {
            const element = document.getElementById(fieldId);
            return element ? (parseInt(element.value) || defaultVal) : defaultVal;
        }

        function setFieldValue(fieldId, value) {
            const element = document.getElementById(fieldId);
            if (element) element.value = value;
        }

        function updateDisplay(displayId, text) {
            const element = document.getElementById(displayId);
            if (element) element.textContent = text;
        }

        function getFieldText(fieldId) {
            const element = document.getElementById(fieldId);
            return element ? element.value : '';
        }

        // Tab switching functionality
        function switchToTab(targetTab) {
            // Remove active classes
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active classes to target
            event.target.classList.add('active');
            document.getElementById(targetTab).classList.add('active');
            
            // Auto-sync when switching to budget tab
            if (targetTab === 'budget') {
                syncBasicToBudget();
            }
            
            // Update scenario analysis when switching to scenarios
            if (targetTab === 'scenarios') {
                refreshScenarioAnalysis();
            }
        }

        // Apply employee type defaults
        function applyEmployeeDefaults() {
            currentEmployeeType = document.getElementById('employeeType').value;
            
            // Set utilization and defaults based on employee type
            switch(currentEmployeeType) {
                case 'People Leader':
                    setFieldValue('utilization', 50);
                    setFieldValue('travel', 68); // 27 * 2.5
                    setFieldValue('admin', 113); // 45 for People Leader * 2.5
                    setFieldValue('hiring', 50); // 20 for People Leader * 2.5
                    // Scale strategic categories by 2.5x
                    setFieldValue('innovation', 48); // 19 * 2.5
                    setFieldValue('culture', 55); // 22 * 2.5
                    setFieldValue('volunteer', 20); // 8 * 2.5
                    setFieldValue('optionalDev', 43); // 17 * 2.5
                    setFieldValue('businessActivities', 138); // 55 * 2.5
                    break;
                default: // Individual Contributor
                    setFieldValue('utilization', 80);
                    setFieldValue('travel', 27);
                    setFieldValue('admin', 25); // IC admin default
                    setFieldValue('hiring', 8); // IC reduced hiring
                    // Standard IC defaults
                    setFieldValue('innovation', 19);
                    setFieldValue('culture', 22);
                    setFieldValue('volunteer', 8);
                    setFieldValue('optionalDev', 17);
                    setFieldValue('businessActivities', 55);
                    break;
            }
            
            runBasicCalculations();
            applyBudgetDefaults();
        }

        // Apply budget defaults based on employee type
        function applyBudgetDefaults() {
            // Administrative defaults based on employee type
            if (currentEmployeeType === 'People Leader') {
                setFieldValue('budgetReviews', 50); // 20 * 2.5
                setFieldValue('budgetReporting', 48); // 19 * 2.5
                setFieldValue('budgetSurveys', 15); // 6 * 2.5
                setFieldValue('budgetOnboarding', 30); // 12 * 2.5
            } else {
                // Individual Contributor
                setFieldValue('budgetReviews', 7);
                setFieldValue('budgetReporting', 12);
                setFieldValue('budgetSurveys', 6);
                setFieldValue('budgetOnboarding', 0); // IC no onboarding
            }
            
            runBudgetCalculations();
        }

        // Basic planning calculations
        function runBasicCalculations() {
            const totalHours = getFieldValue('totalHours', 2080);
            const utilization = getFieldValue('utilization', 80);
            
            // Calculate billable and indirect hours
            const billableHours = Math.round(totalHours * (utilization / 100));
            const indirectHours = totalHours - billableHours;
            
            // Update displays
            updateDisplay('totalHoursDisplay', totalHours);
            updateDisplay('utilizationDisplay', utilization + '%');
            updateDisplay('billableHoursDisplay', billableHours.toLocaleString());
            updateDisplay('indirectHoursDisplay', indirectHours.toLocaleString());
            
            // Update category displays
            updateDisplay('ptoDisplay', getFieldValue('pto', 120));
            updateDisplay('holidaysDisplay', getFieldValue('holidays', 64));
            updateDisplay('travelDisplay', getFieldValue('travel', 27));
            updateDisplay('businessTrainingDisplay', getFieldValue('businessTraining', 13));
            updateDisplay('techTrainingDisplay', getFieldValue('techTraining', 30));
            updateDisplay('hiringDisplay', getFieldValue('hiring', 8));
            updateDisplay('adminDisplay', getFieldValue('admin', 25));
            updateDisplay('innovationDisplay', getFieldValue('innovation', 19));
            updateDisplay('cultureDisplay', getFieldValue('culture', 22));
            updateDisplay('volunteerDisplay', getFieldValue('volunteer', 8));
            updateDisplay('optionalDevDisplay', getFieldValue('optionalDev', 17));
            updateDisplay('businessActivitiesDisplay', getFieldValue('businessActivities', 55));
            
            // Calculate total allocated
            const totalAllocated = getFieldValue('pto', 120) + getFieldValue('holidays', 64) + 
                                 getFieldValue('travel', 27) + getFieldValue('businessTraining', 13) + 
                                 getFieldValue('techTraining', 30) + getFieldValue('hiring', 8) + 
                                 getFieldValue('admin', 25) + getFieldValue('innovation', 19) + 
                                 getFieldValue('culture', 22) + getFieldValue('volunteer', 8) + 
                                 getFieldValue('optionalDev', 17) + getFieldValue('businessActivities', 55);
            
            const bufferTime = indirectHours - totalAllocated;
            
            updateDisplay('totalAllocatedDisplay', totalAllocated);
            updateDisplay('bufferTimeDisplay', bufferTime);
            
            // Update status message
            const statusElement = document.getElementById('basicStatusMessage');
            if (bufferTime < 0) {
                statusElement.textContent = `Over allocated by ${Math.abs(bufferTime)} hours`;
                statusElement.className = 'summary error';
            } else if (bufferTime === 0) {
                statusElement.textContent = 'Perfectly allocated';
                statusElement.className = 'summary';
            } else {
                statusElement.textContent = `${bufferTime} hours remaining`;
                statusElement.className = 'summary';
            }
            
            // Update budget buffer display to match basic planning
            updateDisplay('budgetBufferDisplay', bufferTime);
        }

        // Sync basic planning to budget planning
        function syncBasicToBudget() {
            // Sync PTO directly
            setFieldValue('budgetPTO', getFieldValue('pto', 120));
            
            // Travel - distribute total travel hours proportionally
            const totalTravel = getFieldValue('travel', 27);
            // Fixed distribution maintaining 27 total
            setFieldValue('budgetConferenceTravel', 7);
            setFieldValue('budgetTrainingTravel', 7);
            setFieldValue('budgetClientTravel', 6);
            setFieldValue('budgetTeamOffsitesTravel', 7);
            setFieldValue('budgetTravelOther', Math.max(0, totalTravel - 27));
            
            // Distribute required training proportionally - maintain 13 total
            const businessTraining = getFieldValue('businessTraining', 13);
            setFieldValue('budgetCompliance', 4);
            setFieldValue('budgetLeadership', 5);
            setFieldValue('budgetPlatform', 4);
            setFieldValue('budgetBusinessTrainingOther', Math.max(0, businessTraining - 13));
            
            // Distribute technical training - maintain 30 total
            const techTraining = getFieldValue('techTraining', 30);
            setFieldValue('budgetCertifications', 15);
            setFieldValue('budgetUpskilling', 15);
            setFieldValue('budgetTechTrainingOther', Math.max(0, techTraining - 30));
            
            // Distribute hiring based on employee type
            const hiring = getFieldValue('hiring', 8);
            if (currentEmployeeType === 'People Leader') {
                setFieldValue('budgetRecruiting', Math.round(hiring * 0.25));
                setFieldValue('budgetInterviewing', Math.round(hiring * 0.75));
                setFieldValue('budgetOnboarding', 30); // Scaled for People Leader
                setFieldValue('budgetHiringOther', 0);
            } else {
                setFieldValue('budgetRecruiting', 2);
                setFieldValue('budgetInterviewing', 6);
                setFieldValue('budgetOnboarding', 0);
                setFieldValue('budgetHiringOther', 0);
            }
            
            // Administrative - maintain exact totals based on employee type
            if (currentEmployeeType === 'People Leader') {
                // Already set by applyBudgetDefaults - don't override
            } else {
                // IC defaults - maintain 25 total
                setFieldValue('budgetReviews', 7);
                setFieldValue('budgetReporting', 12);
                setFieldValue('budgetSurveys', 6);
                setFieldValue('budgetAdminOther', 0);
            }
            
            // Distribute innovation/strategy - maintain 19 total for IC
            const innovation = getFieldValue('innovation', 19);
            setFieldValue('budgetInnovationProjects', 10);
            setFieldValue('budgetDigitalTransform', 9);
            setFieldValue('budgetInnovationOther', Math.max(0, innovation - 19));
            
            // Distribute culture (excluding volunteer which is separate) - maintain 22 total for IC
            const culture = getFieldValue('culture', 22);
            const connectivityHours = 8; // Fixed default
            const wellbeingHours = 7; // Fixed default
            setFieldValue('budgetWellbeing', wellbeingHours);
            setFieldValue('budgetConnectivity', connectivityHours);
            setFieldValue('budgetCultureOther', 0); // ERG Member (7) + Wellbeing (7) + Connectivity (8) = 22
            
            // Set volunteer directly
            setFieldValue('budgetVolunteer', getFieldValue('volunteer', 8));
            
            // Distribute optional development - maintain 17 total for IC
            const optionalDev = getFieldValue('optionalDev', 17);
            setFieldValue('budgetExternalConf', 8);
            setFieldValue('budgetExternalTraining', 9);
            setFieldValue('budgetOptionalDevOther', Math.max(0, optionalDev - 17));
            
            // Business activities - maintain 55 total for IC
            const totalBusinessActivities = getFieldValue('businessActivities', 55);
            setFieldValue('budgetTeamMeetings', 26);
            setFieldValue('budgetTownHalls', 6);
            setFieldValue('budgetCheckins', 16);
            setFieldValue('budgetTeamOffsitesBusiness', 7);
            setFieldValue('budgetProposals', 0);
            setFieldValue('budgetBusinessOther', Math.max(0, totalBusinessActivities - 55));
            
            runBudgetCalculations();
        }

        // Budget planning calculations
        function runBudgetCalculations() {
            // Calculate category totals
            const ptoTotal = getFieldValue('budgetPTO', 120);
            
            const travelTotal = getFieldValue('budgetConferenceTravel', 7) + 
                              getFieldValue('budgetTrainingTravel', 7) + 
                              getFieldValue('budgetClientTravel', 6) + 
                              getFieldValue('budgetTeamOffsitesTravel', 7) +
                              getFieldValue('budgetTravelOther', 0);
            
            const trainingTotal = getFieldValue('budgetCompliance', 4) + 
                                getFieldValue('budgetLeadership', 5) + 
                                getFieldValue('budgetPlatform', 4) + 
                                getFieldValue('budgetBusinessTrainingOther', 0);
            
            const techTrainingTotal = getFieldValue('budgetCertifications', 15) + 
                                    getFieldValue('budgetUpskilling', 15) + 
                                    getFieldValue('budgetTechTrainingOther', 0);
            
            const hiringTotal = getFieldValue('budgetRecruiting', 2) + 
                              getFieldValue('budgetInterviewing', 6) + 
                              getFieldValue('budgetOnboarding', 0) + 
                              getFieldValue('budgetHiringOther', 0);
            
            const adminTotal = getFieldValue('budgetReviews', 7) + 
                             getFieldValue('budgetReporting', 12) + 
                             getFieldValue('budgetSurveys', 6) + 
                             getFieldValue('budgetAdminOther', 0);
            
            const innovationTotal = getFieldValue('budgetInnovationProjects', 10) + 
                                  getFieldValue('budgetDigitalTransform', 9) + 
                                  getFieldValue('budgetInnovationOther', 0);
            
            const cultureTotal = getFieldValue('budgetERGMember', 7) + 
                               getFieldValue('budgetERGLeader', 0) + 
                               getFieldValue('budgetERGDevelopment', 0) +
                               getFieldValue('budgetEXCouncil', 0) +
                               getFieldValue('budgetCultureMember', 0) +
                               getFieldValue('budgetCultureChair', 0) +
                               getFieldValue('budgetWellbeing', 7) + 
                               getFieldValue('budgetConnectivity', 8) + 
                               getFieldValue('budgetCultureOther', 0) +
                               getFieldValue('budgetVolunteer', 8);
            
            const devTotal = getFieldValue('budgetExternalConf', 8) + 
                           getFieldValue('budgetExternalTraining', 9) + 
                           getFieldValue('budgetOptionalDevOther', 0);
            
            const businessTotal = getFieldValue('budgetTeamMeetings', 26) + 
                                getFieldValue('budgetTownHalls', 6) + 
                                getFieldValue('budgetCheckins', 16) + 
                                getFieldValue('budgetTeamOffsitesBusiness', 7) +
                                getFieldValue('budgetProposals', 0) +
                                getFieldValue('budgetBusinessOther', 0);
            
            // Calculate totals (holidays = 64, included in essential)
            const essentialTotal = ptoTotal + 64 + travelTotal + trainingTotal + techTrainingTotal + hiringTotal + adminTotal;
            const strategicTotal = innovationTotal + cultureTotal + devTotal + businessTotal;
            const grandTotal = essentialTotal + strategicTotal;
            
            // Update displays
            updateDisplay('budgetEssentialTotalDisplay', essentialTotal);
            updateDisplay('budgetStrategicTotalDisplay', strategicTotal);
            updateDisplay('budgetGrandTotalDisplay', grandTotal);
            
            // Calculate buffer time to match basic planning calculation
            const totalIndirect = getFieldValue('totalHours', 2080) * (1 - getFieldValue('utilization', 80) / 100);
            const bufferTime = totalIndirect - grandTotal;
            updateDisplay('budgetRemainingBufferDisplay', Math.round(bufferTime));
            
            // Update status
            const statusElement = document.getElementById('budgetStatusMessage');
            if (bufferTime < 0) {
                statusElement.textContent = `Over budget by ${Math.abs(Math.round(bufferTime))} hours`;
                statusElement.className = 'summary error';
            } else if (bufferTime === 0) {
                statusElement.textContent = 'Budget perfectly balanced';
                statusElement.className = 'summary';
            } else {
                statusElement.textContent = `${Math.round(bufferTime)} hours remaining`;
                statusElement.className = 'summary';
            }
            
            // Update all budget result displays
            updateAllBudgetDisplays();
            updateGuidelinesAnalysis();
        }

        // Update all budget result displays
        function updateAllBudgetDisplays() {
            updateDisplay('budgetPTODisplay', getFieldValue('budgetPTO', 120));
            updateDisplay('budgetConferenceTravelDisplay', getFieldValue('budgetConferenceTravel', 7));
            updateDisplay('budgetTrainingTravelDisplay', getFieldValue('budgetTrainingTravel', 7));
            updateDisplay('budgetClientTravelDisplay', getFieldValue('budgetClientTravel', 6));
            updateDisplay('budgetTeamOffsitesTravelDisplay', getFieldValue('budgetTeamOffsitesTravel', 7));
            updateDisplay('budgetTravelOtherDisplay', getFieldValue('budgetTravelOther', 0));
            updateDisplay('budgetComplianceDisplay', getFieldValue('budgetCompliance', 4));
            updateDisplay('budgetLeadershipDisplay', getFieldValue('budgetLeadership', 5));
            updateDisplay('budgetPlatformDisplay', getFieldValue('budgetPlatform', 4));
            updateDisplay('budgetBusinessTrainingOtherDisplay', getFieldValue('budgetBusinessTrainingOther', 0));
            updateDisplay('budgetCertificationsDisplay', getFieldValue('budgetCertifications', 15));
            updateDisplay('budgetUpskillingDisplay', getFieldValue('budgetUpskilling', 15));
            updateDisplay('budgetTechTrainingOtherDisplay', getFieldValue('budgetTechTrainingOther', 0));
            updateDisplay('budgetRecruitingDisplay', getFieldValue('budgetRecruiting', 2));
            updateDisplay('budgetInterviewingDisplay', getFieldValue('budgetInterviewing', 6));
            updateDisplay('budgetOnboardingDisplay', getFieldValue('budgetOnboarding', 0));
            updateDisplay('budgetHiringOtherDisplay', getFieldValue('budgetHiringOther', 0));
            updateDisplay('budgetReviewsDisplay', getFieldValue('budgetReviews', 7));
            updateDisplay('budgetReportingDisplay', getFieldValue('budgetReporting', 12));
            updateDisplay('budgetSurveysDisplay', getFieldValue('budgetSurveys', 6));
            updateDisplay('budgetAdminOtherDisplay', getFieldValue('budgetAdminOther', 0));
            updateDisplay('budgetInnovationProjectsDisplay', getFieldValue('budgetInnovationProjects', 10));
            updateDisplay('budgetDigitalTransformDisplay', getFieldValue('budgetDigitalTransform', 9));
            updateDisplay('budgetInnovationOtherDisplay', getFieldValue('budgetInnovationOther', 0));
            updateDisplay('budgetERGMemberDisplay', getFieldValue('budgetERGMember', 7));
            updateDisplay('budgetERGLeaderDisplay', getFieldValue('budgetERGLeader', 0));
            updateDisplay('budgetERGDevelopmentDisplay', getFieldValue('budgetERGDevelopment', 0));
            updateDisplay('budgetEXCouncilDisplay', getFieldValue('budgetEXCouncil', 0));
            updateDisplay('budgetCultureMemberDisplay', getFieldValue('budgetCultureMember', 0));
            updateDisplay('budgetCultureChairDisplay', getFieldValue('budgetCultureChair', 0));
            updateDisplay('budgetWellbeingDisplay', getFieldValue('budgetWellbeing', 7));
            updateDisplay('budgetConnectivityDisplay', getFieldValue('budgetConnectivity', 8));
            updateDisplay('budgetCultureOtherDisplay', getFieldValue('budgetCultureOther', 0));
            updateDisplay('budgetVolunteerDisplay', getFieldValue('budgetVolunteer', 8));
            updateDisplay('budgetExternalConfDisplay', getFieldValue('budgetExternalConf', 8));
            updateDisplay('budgetExternalTrainingDisplay', getFieldValue('budgetExternalTraining', 9));
            updateDisplay('budgetOptionalDevOtherDisplay', getFieldValue('budgetOptionalDevOther', 0));
            updateDisplay('budgetTeamMeetingsDisplay', getFieldValue('budgetTeamMeetings', 26));
            updateDisplay('budgetTownHallsDisplay', getFieldValue('budgetTownHalls', 6));
            updateDisplay('budgetCheckinsDisplay', getFieldValue('budgetCheckins', 16));
            updateDisplay('budgetTeamOffsitesBusinessDisplay', getFieldValue('budgetTeamOffsitesBusiness', 7));
            updateDisplay('budgetProposalsDisplay', getFieldValue('budgetProposals', 0));
            updateDisplay('budgetBusinessOtherDisplay', getFieldValue('budgetBusinessOther', 0));
        }

        // Update guidelines analysis with live calculations
        function updateGuidelinesAnalysis() {
            // Calculate total strategic time
            const strategicTotal = getFieldValue('budgetInnovationProjects', 10) + 
                                 getFieldValue('budgetDigitalTransform', 9) + 
                                 getFieldValue('budgetInnovationOther', 0) +
                                 getFieldValue('budgetERGMember', 7) + 
                                 getFieldValue('budgetERGLeader', 0) + 
                                 getFieldValue('budgetERGDevelopment', 0) +
                                 getFieldValue('budgetEXCouncil', 0) +
                                 getFieldValue('budgetCultureMember', 0) +
                                 getFieldValue('budgetCultureChair', 0) +
                                 getFieldValue('budgetWellbeing', 7) + 
                                 getFieldValue('budgetConnectivity', 8) + 
                                 getFieldValue('budgetCultureOther', 0) +
                                 getFieldValue('budgetVolunteer', 8) +
                                 getFieldValue('budgetExternalConf', 8) + 
                                 getFieldValue('budgetExternalTraining', 9) + 
                                 getFieldValue('budgetOptionalDevOther', 0) +
                                 getFieldValue('budgetTeamMeetings', 26) + 
                                 getFieldValue('budgetTownHalls', 6) + 
                                 getFieldValue('budgetCheckins', 16) + 
                                 getFieldValue('budgetTeamOffsitesBusiness', 7) +
                                 getFieldValue('budgetProposals', 0) +
                                 getFieldValue('budgetBusinessOther', 0);
            
            // Calculate actual hours by framework category
            const devActualHours = getFieldValue('budgetExternalConf', 8) + 
                                  getFieldValue('budgetExternalTraining', 9) + 
                                  getFieldValue('budgetOptionalDevOther', 0);
            
            const cultureActualHours = getFieldValue('budgetERGMember', 7) + 
                                      getFieldValue('budgetERGLeader', 0) + 
                                      getFieldValue('budgetERGDevelopment', 0) +
                                      getFieldValue('budgetEXCouncil', 0) +
                                      getFieldValue('budgetCultureMember', 0) +
                                      getFieldValue('budgetCultureChair', 0) +
                                      getFieldValue('budgetWellbeing', 7) + 
                                      getFieldValue('budgetConnectivity', 8) + 
                                      getFieldValue('budgetCultureOther', 0) +
                                      getFieldValue('budgetVolunteer', 8);
            
            const businessActualHours = getFieldValue('budgetInnovationProjects', 10) + 
                                       getFieldValue('budgetDigitalTransform', 9) + 
                                       getFieldValue('budgetInnovationOther', 0) +
                                       getFieldValue('budgetTeamMeetings', 26) + 
                                       getFieldValue('budgetTownHalls', 6) + 
                                       getFieldValue('budgetCheckins', 16) + 
                                       getFieldValue('budgetTeamOffsitesBusiness', 7) +
                                       getFieldValue('budgetProposals', 0) +
                                       getFieldValue('budgetBusinessOther', 0);
            
            // Calculate framework targets
            const devTargetHours = Math.round(strategicTotal * 0.20);
            const cultureTargetHours = Math.round(strategicTotal * 0.30);
            const businessTargetHours = strategicTotal - devTargetHours - cultureTargetHours;
            
            // Calculate percentages
            const devActualPercent = strategicTotal > 0 ? Math.round((devActualHours / strategicTotal) * 100) : 0;
            const cultureActualPercent = strategicTotal > 0 ? Math.round((cultureActualHours / strategicTotal) * 100) : 0;
            const businessActualPercent = strategicTotal > 0 ? Math.round((businessActualHours / strategicTotal) * 100) : 0;
            
            // Update displays
            updateDisplay('devTargetHours', devTargetHours);
            updateDisplay('devActualHours', devActualHours);
            updateDisplay('devActualPercent', devActualPercent);
            updateDisplay('cultureTargetHours', cultureTargetHours);
            updateDisplay('cultureActualHours', cultureActualHours);
            updateDisplay('cultureActualPercent', cultureActualPercent);
            updateDisplay('businessTargetHours', businessTargetHours);
            updateDisplay('businessActualHours', businessActualHours);
            updateDisplay('businessActualPercent', businessActualPercent);
            
            // Update compliance status
            const devStatus = Math.abs(devActualHours - devTargetHours) <= 2 ? 'On Target' : 
                             devActualHours > devTargetHours ? 'Over Target' : 'Under Target';
            const cultureStatus = Math.abs(cultureActualHours - cultureTargetHours) <= 2 ? 'On Target' : 
                                 cultureActualHours > cultureTargetHours ? 'Over Target' : 'Under Target';
            const businessStatus = Math.abs(businessActualHours - businessTargetHours) <= 2 ? 'On Target' : 
                                  businessActualHours > businessTargetHours ? 'Over Target' : 'Under Target';
            
            updateDisplay('devComplianceStatus', devStatus);
            updateDisplay('cultureComplianceStatus', cultureStatus);
            updateDisplay('businessComplianceStatus', businessStatus);
        }

        // Sync budget planning back to basic planning
        function syncBudgetToBasic() {
            // Roll up budget categories back to basic planning
            const innovationTotal = getFieldValue('budgetInnovationProjects', 10) + 
                                   getFieldValue('budgetDigitalTransform', 9) + 
                                   getFieldValue('budgetInnovationOther', 0);
            setFieldValue('innovation', innovationTotal);
            
            const cultureTotal = getFieldValue('budgetERGMember', 7) + 
                               getFieldValue('budgetERGLeader', 0) + 
                               getFieldValue('budgetERGDevelopment', 0) +
                               getFieldValue('budgetEXCouncil', 0) +
                               getFieldValue('budgetCultureMember', 0) +
                               getFieldValue('budgetCultureChair', 0) +
                               getFieldValue('budgetWellbeing', 7) + 
                               getFieldValue('budgetConnectivity', 8) + 
                               getFieldValue('budgetCultureOther', 0);
            setFieldValue('culture', cultureTotal);
            
            const optionalDevTotal = getFieldValue('budgetExternalConf', 8) + 
                                   getFieldValue('budgetExternalTraining', 9) + 
                                   getFieldValue('budgetOptionalDevOther', 0);
            setFieldValue('optionalDev', optionalDevTotal);
            
            // Business Activities - combine team meetings, town halls, check-ins, and team offsites business
            const businessActivitiesTotal = getFieldValue('budgetTeamMeetings', 26) + 
                                          getFieldValue('budgetTownHalls', 6) + 
                                          getFieldValue('budgetCheckins', 16) + 
                                          getFieldValue('budgetTeamOffsitesBusiness', 7) +
                                          getFieldValue('budgetProposals', 0) +
                                          getFieldValue('budgetBusinessOther', 0);
            setFieldValue('businessActivities', businessActivitiesTotal);
            
            // Travel - combine all travel categories including team offsites travel
            const travelTotal = getFieldValue('budgetConferenceTravel', 7) + 
                              getFieldValue('budgetTrainingTravel', 7) + 
                              getFieldValue('budgetClientTravel', 6) + 
                              getFieldValue('budgetTeamOffsitesTravel', 7) +
                              getFieldValue('budgetTravelOther', 0);
            setFieldValue('travel', travelTotal);
            
            const businessTrainingTotal = getFieldValue('budgetCompliance', 4) + 
                                        getFieldValue('budgetLeadership', 5) + 
                                        getFieldValue('budgetPlatform', 4) + 
                                        getFieldValue('budgetBusinessTrainingOther', 0);
            setFieldValue('businessTraining', businessTrainingTotal);
            
            const techTrainingTotal = getFieldValue('budgetCertifications', 15) + 
                                    getFieldValue('budgetUpskilling', 15) + 
                                    getFieldValue('budgetTechTrainingOther', 0);
            setFieldValue('techTraining', techTrainingTotal);
            
            const hiringTotal = getFieldValue('budgetRecruiting', 2) + 
                              getFieldValue('budgetInterviewing', 6) + 
                              getFieldValue('budgetOnboarding', 0) + 
                              getFieldValue('budgetHiringOther', 0);
            setFieldValue('hiring', hiringTotal);
            
            const adminTotal = getFieldValue('budgetReviews', 7) + 
                             getFieldValue('budgetReporting', 12) + 
                             getFieldValue('budgetSurveys', 6) + 
                             getFieldValue('budgetAdminOther', 0);
            setFieldValue('admin', adminTotal);
            
            setFieldValue('pto', getFieldValue('budgetPTO', 120));
            setFieldValue('volunteer', getFieldValue('budgetVolunteer', 8));
            
            runBasicCalculations();
            alert('Budget Planning has been successfully synced to Basic Planning!');
        }

        // Update scenario analysis
        function refreshScenarioAnalysis() {
            const empType = document.getElementById('employeeType').value;
            const utilization = getFieldValue('utilization', 80);
            const totalHours = getFieldValue('totalHours', 2080);
            const billableHours = Math.round(totalHours * (utilization / 100));
            const indirectHours = totalHours - billableHours;
            
            let analysisHTML = `
                <h4>Current Configuration: ${empType}</h4>
                <p><strong>Utilization:</strong> ${utilization}% (${billableHours.toLocaleString()} billable hours)</p>
                <p><strong>Indirect Hours:</strong> ${indirectHours.toLocaleString()} hours available</p>
                <p><strong>Strategic Time:</strong> ~${Math.max(0, indirectHours - 287)} hours after essential categories</p>
            `;
            
            if (empType === 'People Leader') {
                analysisHTML += `
                    <p><strong>Leadership Focus:</strong> Substantial time available for team development, strategic initiatives, and cultural leadership.</p>
                    <p><strong>Recommended Allocation:</strong> Development (20%), Culture (30%), Business (50%).</p>
                `;
            } else {
                analysisHTML += `
                    <p><strong>Balanced Approach:</strong> Standard allocation following 20/30/50 framework.</p>
                    <p><strong>Recommended Allocation:</strong> Development (20%), Culture (30%), Business (50%).</p>
                `;
            }
            
            document.getElementById('scenarioAnalysisDisplay').innerHTML = analysisHTML;
        }

        // Export functions
        function exportBasicCPM() {
            try {
                const empName = getFieldText('employeeName') || 'Employee';
                const empType = document.getElementById('employeeType').value;
                const lls = document.getElementById('lls').value;
                
                // Calculate hours for CPM export
                const billableHours = Math.round(getFieldValue('totalHours', 2080) * (getFieldValue('utilization', 80) / 100));
                const ptoHours = getFieldValue('pto', 120);
                const allOtherIndirect = getFieldValue('holidays', 64) + getFieldValue('travel', 27) + 
                                       getFieldValue('businessTraining', 13) + getFieldValue('techTraining', 30) + 
                                       getFieldValue('hiring', 8) + getFieldValue('admin', 25) + 
                                       getFieldValue('innovation', 19) + getFieldValue('culture', 22) + 
                                       getFieldValue('volunteer', 8) + getFieldValue('optionalDev', 17) + 
                                       getFieldValue('businessActivities', 55);
                
                // Month percentages for 2026
                const months2026 = [
                    {month: 'January', percentage: 8.65},
                    {month: 'February', percentage: 7.69},
                    {month: 'March', percentage: 8.65},
                    {month: 'April', percentage: 8.27},
                    {month: 'May', percentage: 8.27},
                    {month: 'June', percentage: 8.65},
                    {month: 'July', percentage: 8.65},
                    {month: 'August', percentage: 8.65},
                    {month: 'September', percentage: 8.27},
                    {month: 'October', percentage: 8.65},
                    {month: 'November', percentage: 7.69},
                    {month: 'December', percentage: 7.31}
                ];
                
                // Build CPM data array
                let cpmData = [];
                
                // Header row - employee info in A,B,C then months D through O, total in P
                let headerRow = ['Employee Name: ' + empName, 'Employee Type: ' + empType, 'LLS: ' + lls];
                months2026.forEach(month => headerRow.push(month.month + ' 2026'));
                headerRow.push('Total 2026');
                cpmData.push(headerRow);
                
                // Empty row
                cpmData.push(['']);
                
                // Direct Override (Billable vs. Indirect)
                cpmData.push(['Direct Override (Billable Hours)', '', '']);
                
                let directOverrideRow = ['  Direct Override', '', ''];
                let directTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(billableHours * (month.percentage / 100));
                    directOverrideRow.push(monthlyHours);
                    directTotal += monthlyHours;
                });
                directOverrideRow.push(directTotal);
                cpmData.push(directOverrideRow);
                
                // Bold Step Hours
                cpmData.push(['Bold Step Hours', '', '']);
                
                let boldStepRow = ['  Bold Step Override', '', ''];
                const boldStepHours = getFieldValue('innovation', 19);
                let boldTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(boldStepHours * (month.percentage / 100));
                    boldStepRow.push(monthlyHours);
                    boldTotal += monthlyHours;
                });
                boldStepRow.push(boldTotal);
                cpmData.push(boldStepRow);
                
                // PTO Usage Override
                cpmData.push(['PTO Usage Override', '', '']);
                
                let ptoOverrideRow = ['  PTO Usage Override', '', ''];
                let ptoTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(ptoHours * (month.percentage / 100));
                    ptoOverrideRow.push(monthlyHours);
                    ptoTotal += monthlyHours;
                });
                ptoOverrideRow.push(ptoTotal);
                cpmData.push(ptoOverrideRow);
                
                // All other Indirect Hours (Holiday hours included here, not separately tracked)
                cpmData.push(['All other Indirect Hours', '', '']);
                
                let allOtherRow = ['  All other Indirect Override', '', ''];
                let allOtherTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(allOtherIndirect * (month.percentage / 100));
                    allOtherRow.push(monthlyHours);
                    allOtherTotal += monthlyHours;
                });
                allOtherRow.push(allOtherTotal);
                cpmData.push(allOtherRow);
                
                // Convert to CSV format
                let csvContent = '';
                cpmData.forEach(row => {
                    let csvRow = row.map(cell => {
                        if (typeof cell === 'string' && cell.indexOf(',') !== -1) {
                            return '"' + cell + '"';
                        }
                        return cell;
                    }).join(',');
                    csvContent += csvRow + '\n';
                });
                
                // Create download
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = empName.replace(/\s+/g, '_') + '_Basic_CPM_2026.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                alert('Basic CPM Export Complete!\n\nFile: ' + empName.replace(/\s+/g, '_') + '_Basic_CPM_2026.csv\n\nThis file is ready for direct import into your company CRM system.\n\nNote: Holiday hours are included in All Other Indirect Hours.');
                
            } catch (error) {
                alert('Basic CPM export failed. Please try again or contact support.');
                console.error('Basic CPM Export Error:', error);
            }
        }

        function exportBudgetCPM() {
            try {
                const empName = getFieldText('employeeName') || 'Employee';
                const empType = document.getElementById('employeeType').value;
                const lls = document.getElementById('lls').value;
                
                // Calculate totals for CPM categories from budget planning
                const billableHours = Math.round(getFieldValue('totalHours', 2080) * (getFieldValue('utilization', 80) / 100));
                
                // Bold Step = Strategy/Innovation from budget
                const boldStepHours = getFieldValue('budgetInnovationProjects', 10) + 
                                     getFieldValue('budgetDigitalTransform', 9) + 
                                     getFieldValue('budgetInnovationOther', 0);
                
                // PTO = PTO categories only
                const ptoHours = getFieldValue('budgetPTO', 120);
                
                // All other indirect = everything else from budget (including holidays)
                const allOtherIndirect = 64 + // Holiday hours (included but not separately tracked)
                                       (getFieldValue('budgetConferenceTravel', 7) + getFieldValue('budgetTrainingTravel', 7) + 
                                        getFieldValue('budgetClientTravel', 6) + getFieldValue('budgetTeamOffsitesTravel', 7) + 
                                        getFieldValue('budgetTravelOther', 0)) +
                                       (getFieldValue('budgetCompliance', 4) + getFieldValue('budgetLeadership', 5) + 
                                        getFieldValue('budgetPlatform', 4) + getFieldValue('budgetBusinessTrainingOther', 0)) +
                                       (getFieldValue('budgetCertifications', 15) + getFieldValue('budgetUpskilling', 15) + 
                                        getFieldValue('budgetTechTrainingOther', 0)) +
                                       (getFieldValue('budgetRecruiting', 2) + getFieldValue('budgetInterviewing', 6) + 
                                        getFieldValue('budgetOnboarding', 0) + getFieldValue('budgetHiringOther', 0)) +
                                       (getFieldValue('budgetReviews', 7) + getFieldValue('budgetReporting', 12) + 
                                        getFieldValue('budgetSurveys', 6) + getFieldValue('budgetAdminOther', 0)) +
                                       (getFieldValue('budgetERGMember', 7) + getFieldValue('budgetERGLeader', 0) + 
                                        getFieldValue('budgetERGDevelopment', 0) + getFieldValue('budgetEXCouncil', 0) +
                                        getFieldValue('budgetCultureMember', 0) + getFieldValue('budgetCultureChair', 0) +
                                        getFieldValue('budgetWellbeing', 7) + getFieldValue('budgetConnectivity', 8) + 
                                        getFieldValue('budgetCultureOther', 0) + getFieldValue('budgetVolunteer', 8)) +
                                       (getFieldValue('budgetExternalConf', 8) + getFieldValue('budgetExternalTraining', 9) + 
                                        getFieldValue('budgetOptionalDevOther', 0)) +
                                       (getFieldValue('budgetTeamMeetings', 26) + getFieldValue('budgetTownHalls', 6) + 
                                        getFieldValue('budgetCheckins', 16) + getFieldValue('budgetTeamOffsitesBusiness', 7) +
                                        getFieldValue('budgetProposals', 0) + getFieldValue('budgetBusinessOther', 0));
                
                // Month percentages for 2026
                const months2026 = [
                    {month: 'January', percentage: 8.65},
                    {month: 'February', percentage: 7.69},
                    {month: 'March', percentage: 8.65},
                    {month: 'April', percentage: 8.27},
                    {month: 'May', percentage: 8.27},
                    {month: 'June', percentage: 8.65},
                    {month: 'July', percentage: 8.65},
                    {month: 'August', percentage: 8.65},
                    {month: 'September', percentage: 8.27},
                    {month: 'October', percentage: 8.65},
                    {month: 'November', percentage: 7.69},
                    {month: 'December', percentage: 7.31}
                ];
                
                // Build CPM data array
                let cpmData = [];
                
                // Header row - employee info in A,B,C then months D through O, total in P
                let headerRow = ['Budget Planning Export: ' + empName, 'Employee Type: ' + empType, 'LLS: ' + lls];
                months2026.forEach(month => headerRow.push(month.month + ' 2026'));
                headerRow.push('Total 2026');
                cpmData.push(headerRow);
                
                // Empty row
                cpmData.push(['']);
                
                // Direct Override (Billable vs. Indirect)
                cpmData.push(['Direct Override (Billable Hours)', '', '']);
                
                let directOverrideRow = ['  Direct Override', '', ''];
                let directTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(billableHours * (month.percentage / 100));
                    directOverrideRow.push(monthlyHours);
                    directTotal += monthlyHours;
                });
                directOverrideRow.push(directTotal);
                cpmData.push(directOverrideRow);
                
                // Bold Step Hours
                cpmData.push(['Bold Step Hours', '', '']);
                
                let boldStepRow = ['  Bold Step Override', '', ''];
                let boldTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(boldStepHours * (month.percentage / 100));
                    boldStepRow.push(monthlyHours);
                    boldTotal += monthlyHours;
                });
                boldStepRow.push(boldTotal);
                cpmData.push(boldStepRow);
                
                // PTO Usage Override
                cpmData.push(['PTO Usage Override', '', '']);
                
                let ptoOverrideRow = ['  PTO Usage Override', '', ''];
                let ptoTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(ptoHours * (month.percentage / 100));
                    ptoOverrideRow.push(monthlyHours);
                    ptoTotal += monthlyHours;
                });
                ptoOverrideRow.push(ptoTotal);
                cpmData.push(ptoOverrideRow);
                
                // All other Indirect Hours
                cpmData.push(['All other Indirect Hours', '', '']);
                
                let allOtherRow = ['  All other Indirect Override', '', ''];
                let allOtherTotal = 0;
                months2026.forEach(month => {
                    const monthlyHours = Math.round(allOtherIndirect * (month.percentage / 100));
                    allOtherRow.push(monthlyHours);
                    allOtherTotal += monthlyHours;
                });
                allOtherRow.push(allOtherTotal);
                cpmData.push(allOtherRow);
                
                // Convert to CSV format
                let csvContent = '';
                cpmData.forEach(row => {
                    let csvRow = row.map(cell => {
                        if (typeof cell === 'string' && cell.indexOf(',') !== -1) {
                            return '"' + cell + '"';
                        }
                        return cell;
                    }).join(',');
                    csvContent += csvRow + '\n';
                });
                
                // Create download
                const blob = new Blob([csvContent], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = empName.replace(/\s+/g, '_') + '_Budget_CPM_2026.csv';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                alert('Budget CPM Export Complete!\n\nFile: ' + empName.replace(/\s+/g, '_') + '_Budget_CPM_2026.csv\n\nDetailed budget categories have been rolled up into CPM format.\n\nNote: Holiday hours are included in All Other Indirect Hours.');
                
            } catch (error) {
                alert('Budget CPM export failed. Please try again or contact support.');
                console.error('Budget CPM Export Error:', error);
            }
        }

        function printPlanningReport() {
            window.print();
        }

        function resetAllData() {
            if (confirm('Are you sure you want to clear all data and start over?')) {
                // Reset employee information
                setFieldValue('employeeName', '');
                document.getElementById('employeeType').selectedIndex = 0;
                document.getElementById('lls').selectedIndex = 0;
                
                // Apply defaults for Individual Contributor
                currentEmployeeType = 'Individual Contributor';
                applyEmployeeDefaults();
                
                alert('All data has been reset for the next employee.');
            }
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', function() {
            currentEmployeeType = 'Individual Contributor';
            applyEmployeeDefaults();
            runBasicCalculations();
            applyBudgetDefaults();
            runBudgetCalculations();
            refreshScenarioAnalysis();
        });
    </script>
</body>
</html>
